<%- include('header.ejs', {title:"μ¥λ°”κµ¬λ‹"})%>
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/stylesheets/cart.css">
</head>
<body>
<!-- β¶ μ „μ²΄ μ»¨ν…μ΄λ„: bodyλ¥Ό flex column μ»¨ν…μ΄λ„λ΅ μ§€μ • -->
<div class="page-container">
    <!-- β· ν—¤λ” (Include) -->
    <%- include('header.ejs', { title: "μ¥λ°”κµ¬λ‹" }) %>

    <!-- βΈ λ©”μΈ μ»¨ν…μΈ : ν™”λ©΄μ—μ„ λ‚¨λ” κ³µκ°„μ„ λ¨λ‘ μ°¨μ§€ -->
    <main class="content-wrap">
        <h2>π›’ <%= user.name %>λ‹μ μ¥λ°”κµ¬λ‹</h2>

        <% if (cartItems.length === 0) { %>
            <p>μ¥λ°”κµ¬λ‹κ°€ λΉ„μ–΄ μμµλ‹λ‹¤.</p>
        <% } else { %>
            <ul class="cart-list">
                <% cartItems.forEach(item => { %>
                    <li class="cart-item">
              <span class="item-info">
                <%= item.emoji %> <%= item.name %> β€“ β‚©<%= item.price.toLocaleString() %> Γ—
              </span>
                        <div class="item-actions">
                            <form action="/cart/update" method="POST" class="qty-form">
                                <input type="hidden" name="productId" value="<%= item.id %>">
                                <button type="submit" name="action" value="decrease" class="qty-btn">β–</button>
                                <span class="qty-number"><%= item.quantity %></span>
                                <button type="submit" name="action" value="increase" class="qty-btn">β•</button>
                            </form>
                            <form action="/cart/delete" method="POST" class="del-form">
                                <input type="hidden" name="productId" value="<%= item.id %>">
                                <button type="submit" class="delete-button">π—‘ μ‚­μ </button>
                            </form>
                        </div>
                    </li>
                <% }) %>
            </ul>
        <% } %>
        <hr>
        <!-- β¤ μ„μ‹λ¦¬μ¤νΈ μ„Ήμ… -->
        <% if (wishlist && wishlist.length > 0) { %>
            <section class="wishlist-section">
                <h3>π’– λ‚΄ μ„μ‹λ¦¬μ¤νΈ</h3>
                <div class="wishlist-grid">
                    <% wishlist.forEach(item => { %>
                        <div class="wishlist-card" data-id="<%= item.id %>">
                            <img
                                    src="/images/<%= item.image || 'default.jpg' %>"
                                    alt="<%= item.name %>"
                                    class="wishlist-thumb"
                            />
                            <div class="wishlist-info">
                                <h4><%= item.emoji %> <%= item.name %></h4>
                                <p class="price">β‚©<%= item.price.toLocaleString() %></p>
                            </div>
                            <div class="wishlist-actions">
                                <form action="/cart/add" method="POST">
                                    <input type="hidden" name="productId" value="<%= item.id %>" />
                                    <button type="submit" class="btn btn-cart">π›’ μ¥λ°”κµ¬λ‹</button>
                                </form>
                                <button type="button" class="btn btn-remove" data-id="<%= item.id %>">
                                    π—‘
                                </button>
                            </div>
                        </div>
                    <% }) %>
                </div>
            </section>
        <% } else { %>
            <p class="empty-wishlist">μ•„μ§ μ„μ‹λ¦¬μ¤νΈκ°€ λΉ„μ–΄ μμµλ‹λ‹¤.</p>
        <% } %>


        <div class="cart-footer-links">
            <a href="/products" class="back-link">β† μƒν’ κ³„μ† λ³΄κΈ°</a>
        </div>

        <form action="/order/confirm" method="POST" class="order-btn-wrapper">
            <button type="submit" class="order-button">β… μ£Όλ¬Έν•κΈ°</button>
        </form>
    </main>

    <!-- βΉ ν‘Έν„° (Include) -->
    <%- include('footer.ejs') %>
</div>
<script src="/javascripts/wishlist.js"></script>
</body>
</html>
